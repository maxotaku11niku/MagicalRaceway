[gd_scene load_steps=23 format=3 uid="uid://dvr3wf81xo871"]

[ext_resource type="Script" path="res://Scripts/PlayMaster.gd" id="1_dxmhm"]
[ext_resource type="Resource" uid="uid://bq5nrx5x6cix7" path="res://Data/Tracks/test.tres" id="2_8i8yp"]
[ext_resource type="Theme" uid="uid://dtf1n084l1n64" path="res://Images/UIElements/defaultTheme.tres" id="2_jevb4"]
[ext_resource type="Theme" uid="uid://b0jjayjhfifnk" path="res://Images/UIElements/numTheme.tres" id="3_6kt2q"]
[ext_resource type="SpriteFrames" uid="uid://c3lguymgm5xjx" path="res://Animations/player.tres" id="4_0qg0g"]
[ext_resource type="Script" path="res://Scripts/PlayUI.gd" id="4_7ctkp"]
[ext_resource type="Texture2D" uid="uid://db7o7lmx1fe5c" path="res://Images/UIElements/progressBarBG.png" id="4_j23ni"]
[ext_resource type="Texture2D" uid="uid://c1fgky81bd5ao" path="res://Images/UIElements/progressBarFG.png" id="5_e8lp0"]
[ext_resource type="Texture2D" uid="uid://ba7dlfljgwl7r" path="res://Images/UIElements/progressBarGirl.png" id="6_j410h"]
[ext_resource type="Material" uid="uid://dfffeidrsnyyr" path="res://Shaders/skyMat.tres" id="8_5ep0t"]
[ext_resource type="Script" path="res://Scripts/SplineRenderer.gd" id="8_esje0"]
[ext_resource type="Script" path="res://Scripts/Sky2D.gd" id="8_sdmq8"]
[ext_resource type="Texture2D" uid="uid://7d3mo2fb47d4" path="res://Images/roadPal.png" id="9_1t8dp"]
[ext_resource type="Texture2D" uid="uid://b064oslcrpnmq" path="res://Images/sky.png" id="9_2wmts"]
[ext_resource type="SpriteFrames" uid="uid://41udobvb28ux" path="res://Animations/countdown.tres" id="9_l5adt"]
[ext_resource type="Texture2D" uid="uid://cqpvhthkv67i1" path="res://Images/UIElements/selectors.png" id="10_2eh55"]
[ext_resource type="Shader" path="res://Shaders/spline.gdshader" id="11_ed6u4"]
[ext_resource type="Script" path="res://Scripts/Pseudo3DSpline.gd" id="11_q2xxr"]
[ext_resource type="Texture2D" uid="uid://b01sg464srnsh" path="res://Images/road.png" id="14_6frcd"]
[ext_resource type="Material" uid="uid://c4gp2oawlvfmo" path="res://Shaders/colMixMat.tres" id="20_8wav0"]
[ext_resource type="Texture2D" uid="uid://dnrn2a2cnesqr" path="res://Images/BGSprites/hometownbg.png" id="20_16sbs"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7np3q"]
shader = ExtResource("11_ed6u4")
shader_parameter/startLine = 128
shader_parameter/numLines = 111
shader_parameter/width = 320
shader_parameter/positLines = 256
shader_parameter/palettised = true
shader_parameter/texPixSize = Vector2(0.007, 0.016)
shader_parameter/pPos = null
shader_parameter/palette = ExtResource("9_1t8dp")

[node name="PlayMaster" type="Node" node_paths=PackedStringArray("splineRenderer", "playUI", "countdownSprite")]
script = ExtResource("1_dxmhm")
currentTrack = ExtResource("2_8i8yp")
splineRenderer = NodePath("SplineRenderer")
playUI = NodePath("PlayUIRoot")
countdownSprite = NodePath("PlayUIRoot/Countdown")
accelPower = 80.0
brakePower = 200.0
turnPower = 90.0
dragFactor = 0.00012
offRoadDragFactor = 0.00036
centrifugalFactor = 0.12

[node name="PlayUIRoot" type="Control" parent="." node_paths=PackedStringArray("MainUI", "DevScreen", "CheckPointNotification", "GoBackNotification")]
z_index = 4000
layout_mode = 3
anchors_preset = 0
offset_right = 320.0
offset_bottom = 240.0
theme = ExtResource("2_jevb4")
script = ExtResource("4_7ctkp")
MainUI = NodePath("MainUI")
DevScreen = NodePath("DevParams")
CheckPointNotification = NodePath("CheckpointNotif")
GoBackNotification = NodePath("GoBackNotif")

[node name="Countdown" type="AnimatedSprite2D" parent="PlayUIRoot"]
visible = false
position = Vector2(160, 120)
sprite_frames = ExtResource("9_l5adt")
frame_progress = 0.450331

[node name="MainUI" type="Control" parent="PlayUIRoot"]
anchors_preset = 0
offset_right = 320.0
offset_bottom = 240.0

[node name="ScoreLabel" type="Label" parent="PlayUIRoot/MainUI"]
layout_mode = 0
offset_left = 48.0
offset_top = 8.0
offset_right = 88.0
offset_bottom = 16.0
theme_override_colors/font_color = Color(0.482353, 1, 0.580392, 1)
text = "SCORE"

[node name="ScoreNum" type="Label" parent="PlayUIRoot/MainUI/ScoreLabel"]
layout_mode = 0
offset_left = -40.0
offset_top = 8.0
offset_right = 56.0
offset_bottom = 24.0
theme = ExtResource("3_6kt2q")
text = "0"
horizontal_alignment = 2

[node name="TimeLabel" type="Label" parent="PlayUIRoot/MainUI"]
layout_mode = 0
offset_left = 144.0
offset_top = 8.0
offset_right = 184.0
offset_bottom = 16.0
theme_override_colors/font_color = Color(1, 0.517647, 0.258824, 1)
text = "TIME"

[node name="TimeNum" type="Label" parent="PlayUIRoot/MainUI/TimeLabel"]
layout_mode = 0
offset_top = 8.0
offset_right = 24.0
offset_bottom = 24.0
theme = ExtResource("3_6kt2q")
text = "0"
horizontal_alignment = 2

[node name="SpeedLabel" type="Label" parent="PlayUIRoot/MainUI"]
layout_mode = 0
offset_left = 40.0
offset_top = 224.0
offset_right = 80.0
offset_bottom = 232.0
theme_override_colors/font_color = Color(0.870588, 0.517647, 1, 1)
text = "KM/H"

[node name="SpeedNum" type="Label" parent="PlayUIRoot/MainUI/SpeedLabel"]
layout_mode = 0
offset_left = -40.0
offset_top = -8.0
offset_right = -8.0
offset_bottom = 8.0
theme = ExtResource("3_6kt2q")
text = "0"
horizontal_alignment = 2

[node name="StageLabel" type="Label" parent="PlayUIRoot/MainUI"]
layout_mode = 0
offset_left = 248.0
offset_top = 224.0
offset_right = 288.0
offset_bottom = 232.0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "STAGE"

[node name="StageNum" type="Label" parent="PlayUIRoot/MainUI/StageLabel"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = 8.0
offset_top = -8.0
offset_right = 24.0
offset_bottom = 8.0
grow_horizontal = 0
theme = ExtResource("3_6kt2q")
text = "1"
horizontal_alignment = 2

[node name="StageProgressBar" type="TextureProgressBar" parent="PlayUIRoot/MainUI"]
self_modulate = Color(0.870588, 0.517647, 1, 1)
layout_mode = 0
offset_left = 216.0
offset_top = 24.0
offset_right = 296.0
offset_bottom = 32.0
max_value = 80.0
step = 0.0
value = 6.0
nine_patch_stretch = true
stretch_margin_left = 2
stretch_margin_right = 2
texture_under = ExtResource("4_j23ni")
texture_progress = ExtResource("5_e8lp0")

[node name="CurrentStageNum" type="Label" parent="PlayUIRoot/MainUI/StageProgressBar"]
layout_mode = 0
offset_left = -16.0
offset_bottom = 8.0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "1"
horizontal_alignment = 2

[node name="NextStageNum" type="Label" parent="PlayUIRoot/MainUI/StageProgressBar"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_right = 16.0
offset_bottom = 8.0
grow_horizontal = 0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "2"

[node name="GirlFigure" type="TextureRect" parent="PlayUIRoot/MainUI/StageProgressBar"]
modulate = Color(0.870588, 0.517647, 1, 1)
layout_mode = 0
offset_left = -4.0
offset_top = -14.0
offset_right = 12.0
offset_bottom = 2.0
texture = ExtResource("6_j410h")

[node name="GrazeLabel" type="Label" parent="PlayUIRoot/MainUI"]
layout_mode = 0
offset_left = 8.0
offset_top = 32.0
offset_right = 48.0
offset_bottom = 48.0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "EDGE
GRAZE"

[node name="GrazeNum" type="Label" parent="PlayUIRoot/MainUI/GrazeLabel"]
layout_mode = 0
offset_left = 48.0
offset_top = 8.0
offset_right = 88.0
offset_bottom = 16.0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "x1.000
"

[node name="GoBackNotif" type="Control" parent="PlayUIRoot"]
visible = false
anchors_preset = 0
offset_top = 48.0
offset_right = 160.0
offset_bottom = 88.0
scale = Vector2(2, 2)

[node name="GoBackLabel" type="Label" parent="PlayUIRoot/GoBackNotif"]
layout_mode = 0
offset_left = 32.0
offset_right = 120.0
offset_bottom = 16.0
theme_override_colors/font_color = Color(1, 0.517647, 0.258824, 1)
text = "THE TRACK'S
THIS WAY!"
horizontal_alignment = 1

[node name="GoBackDir" type="Sprite2D" parent="PlayUIRoot/GoBackNotif"]
modulate = Color(1, 0.517647, 0.258824, 1)
position = Vector2(80, 32)
scale = Vector2(2, 2)
texture = ExtResource("10_2eh55")
region_enabled = true
region_rect = Rect2(0, 8, 8, 8)

[node name="CheckpointNotif" type="Control" parent="PlayUIRoot"]
visible = false
anchors_preset = 0
offset_top = 48.0
offset_right = 160.0
offset_bottom = 96.0
scale = Vector2(2, 2)

[node name="CheckpointLabel" type="Label" parent="PlayUIRoot/CheckpointNotif"]
layout_mode = 0
offset_left = 32.0
offset_right = 120.0
offset_bottom = 8.0
theme_override_colors/font_color = Color(0.482353, 1, 0.580392, 1)
text = "CHECKPOINT!"
horizontal_alignment = 1

[node name="TimeBonusLabel" type="Label" parent="PlayUIRoot/CheckpointNotif"]
layout_mode = 0
offset_left = 32.0
offset_top = 24.0
offset_right = 136.0
offset_bottom = 32.0
theme_override_colors/font_color = Color(1, 0.776471, 0, 1)
text = "s Time Bonus!"

[node name="TimeBonusNum" type="Label" parent="PlayUIRoot/CheckpointNotif/TimeBonusLabel"]
layout_mode = 0
offset_left = -32.0
offset_top = -8.0
offset_bottom = 8.0
theme = ExtResource("3_6kt2q")
text = "69"
horizontal_alignment = 2

[node name="DevParams" type="Control" parent="PlayUIRoot"]
visible = false
anchors_preset = 0
offset_left = 192.0
offset_top = 40.0
offset_right = 312.0
offset_bottom = 240.0

[node name="DistanceLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 24.0
offset_right = 56.0
offset_bottom = 8.0
text = "dist"
horizontal_alignment = 2

[node name="DistanceNum" type="Label" parent="PlayUIRoot/DevParams/DistanceLabel"]
layout_mode = 0
offset_left = 32.0
offset_right = 96.0
offset_bottom = 8.0
text = "0
"
horizontal_alignment = 2

[node name="NextCheckLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 16.0
offset_top = 8.0
offset_right = 56.0
offset_bottom = 16.0
text = "check
"
horizontal_alignment = 2

[node name="NextCheckNum" type="Label" parent="PlayUIRoot/DevParams/NextCheckLabel"]
layout_mode = 0
offset_left = 40.0
offset_right = 104.0
offset_bottom = 8.0
text = "0
"
horizontal_alignment = 2

[node name="XOffLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 24.0
offset_top = 16.0
offset_right = 56.0
offset_bottom = 24.0
text = "xoff"
horizontal_alignment = 2

[node name="XOffNum" type="Label" parent="PlayUIRoot/DevParams/XOffLabel"]
layout_mode = 0
offset_left = 32.0
offset_right = 96.0
offset_bottom = 8.0
text = "0.00
"
horizontal_alignment = 2

[node name="TimeLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 24.0
offset_top = 24.0
offset_right = 56.0
offset_bottom = 32.0
text = "time"
horizontal_alignment = 2

[node name="TimeNum" type="Label" parent="PlayUIRoot/DevParams/TimeLabel"]
layout_mode = 0
offset_left = 32.0
offset_right = 96.0
offset_bottom = 8.0
text = "0.00
"
horizontal_alignment = 2

[node name="TurnLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 24.0
offset_top = 32.0
offset_right = 56.0
offset_bottom = 40.0
text = "turn"
horizontal_alignment = 2

[node name="TurnNum" type="Label" parent="PlayUIRoot/DevParams/TurnLabel"]
layout_mode = 0
offset_left = 32.0
offset_right = 96.0
offset_bottom = 8.0
text = "0.00000
"
horizontal_alignment = 2

[node name="SplitLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 16.0
offset_top = 40.0
offset_right = 56.0
offset_bottom = 48.0
text = "split"
horizontal_alignment = 2

[node name="SplitNum" type="Label" parent="PlayUIRoot/DevParams/SplitLabel"]
layout_mode = 0
offset_left = 40.0
offset_right = 104.0
offset_bottom = 8.0
text = "0.00
"
horizontal_alignment = 2

[node name="PitchLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 16.0
offset_top = 48.0
offset_right = 56.0
offset_bottom = 56.0
text = "pitch"
horizontal_alignment = 2

[node name="PitchNum" type="Label" parent="PlayUIRoot/DevParams/PitchLabel"]
layout_mode = 0
offset_left = 40.0
offset_right = 104.0
offset_bottom = 8.0
text = "0.00000
"
horizontal_alignment = 2

[node name="BalanceLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_left = 16.0
offset_top = 56.0
offset_right = 56.0
offset_bottom = 64.0
text = "cfugb"
horizontal_alignment = 2

[node name="BalanceNum" type="Label" parent="PlayUIRoot/DevParams/BalanceLabel"]
layout_mode = 0
offset_left = 40.0
offset_right = 104.0
offset_bottom = 8.0
text = "0.0000
"
horizontal_alignment = 2

[node name="DevControlsLabel" type="Label" parent="PlayUIRoot/DevParams"]
layout_mode = 0
offset_top = 72.0
offset_right = 120.0
offset_bottom = 80.0
text = "t: toggle timer
c: next check
r: reset"

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(160, 200)
sprite_frames = ExtResource("4_0qg0g")
animation = &"idle_front"

[node name="SplineRenderer" type="Node" parent="." node_paths=PackedStringArray("road", "sky", "bgLayer1Part1", "bgLayer1Part2", "bgLayer2Part1", "bgLayer2Part2")]
script = ExtResource("8_esje0")
road = NodePath("RoadSpline")
sky = NodePath("Sky")
bgLayer1Part1 = NodePath("BGLayer1_1")
bgLayer1Part2 = NodePath("BGLayer1_2")
bgLayer2Part1 = NodePath("BGLayer2_1")
bgLayer2Part2 = NodePath("BGLayer2_2")
screenSize = Vector2i(320, 240)
frontSplinePoints = 250
backSplinePoints = 20
cameraRelativePosition = Vector2(-30, 30)
nearClipPosition = -25.0
farClipPosition = 800.0
bg1TravelFactor = 200.0
bg2TravelFactor = 100.0

[node name="RoadSpline" type="Node2D" parent="SplineRenderer"]
z_index = -512
material = SubResource("ShaderMaterial_7np3q")
script = ExtResource("11_q2xxr")
texture = ExtResource("14_6frcd")
bound = Rect2(0, 128, 320, 112)

[node name="Sky" type="Node2D" parent="SplineRenderer"]
z_index = -4000
material = ExtResource("8_5ep0t")
script = ExtResource("8_sdmq8")
texture = ExtResource("9_2wmts")
bound = Rect2(0, 0, 320, 240)
bottomY = 128.0

[node name="BGLayer1_1" type="Sprite2D" parent="SplineRenderer"]
z_index = -3800
material = ExtResource("20_8wav0")
position = Vector2(0, 88)
texture = ExtResource("20_16sbs")
centered = false
region_enabled = true
region_rect = Rect2(0, 0, 512, 32)

[node name="BGLayer2_1" type="Sprite2D" parent="SplineRenderer"]
z_index = -3900
material = ExtResource("20_8wav0")
position = Vector2(0, 56)
texture = ExtResource("20_16sbs")
centered = false
region_enabled = true
region_rect = Rect2(0, 32, 512, 64)

[node name="BGLayer1_2" type="Sprite2D" parent="SplineRenderer"]
z_index = -3800
material = ExtResource("20_8wav0")
position = Vector2(-512, 88)
texture = ExtResource("20_16sbs")
centered = false
region_enabled = true
region_rect = Rect2(0, 0, 512, 32)

[node name="BGLayer2_2" type="Sprite2D" parent="SplineRenderer"]
z_index = -3900
material = ExtResource("20_8wav0")
position = Vector2(-512, 56)
texture = ExtResource("20_16sbs")
centered = false
region_enabled = true
region_rect = Rect2(0, 32, 512, 64)

[connection signal="animation_looped" from="PlayUIRoot/Countdown" to="." method="_onCountdownAnimationLooped"]
